document.getElementById('upload-ecg').addEventListener('change', e => { const file = e.target.files[0]; if (!file) return; const reader = new FileReader(); reader.onload = event => { const img = new Image(); img.onload = () => { const canvas = document.getElementById('canvas-ecg-static'); const ctx = canvas.getContext('2d'); canvas.width = img.width; canvas.height = img.height; ctx.drawImage(img, 0, 0); enviarParaFlask(file); }; img.src = event.target.result; }; reader.readAsDataURL(file); }); async function enviarParaFlask(file) { const formData = new FormData(); formData.append("file", file); try { const response = await fetch("/analisar", { method: "POST", body: formData }); const data = await response.json(); document.getElementById("descricao-ecg").value = data.descricao || "Sem descrição."; document.getElementById("laudo-final").value = data.laudo || "Sem laudo."; } catch (error) { console.error("Erro ao enviar ECG:", error); alert("Erro ao enviar ECG para análise."); } }
